{% extends "base.html" %}
{% block title %}Experiment Â· QuantSight{% endblock %}
{% block hero %}
<div class="row align-items-center">
  <div class="col-lg-9">
    <h1 class="display-6 fw-semibold mb-2 text-white">Experiment Sweep</h1>
    <p class="lead text-white-50 mb-0">Walk-forward hyperparameter sweep for XGB models with aggregated Sharpe and IR metrics.</p>
  </div>
</div>
{% endblock %}
{% block content %}
<div class="content-card mb-4">
  <h2 class="h5 mb-3">Configure Sweep</h2>
  <form id="exp-form" class="row g-2" onsubmit="return false;">
    <div class="col-md-3">
      <label class="form-label">Ticker</label>
      <input id="exp-ticker" class="form-control" value="AAPL" />
    </div>
    <div class="col-md-2">
      <label class="form-label">Start</label>
      <input id="exp-start" type="date" class="form-control" value="2015-01-01" />
    </div>
    <div class="col-md-2">
      <label class="form-label">Horizon</label>
      <select id="exp-horizon" class="form-select">
        <option value="1d" selected>1d</option>
        <option value="5d">5d</option>
        <option value="20d">20d</option>
      </select>
    </div>
    <div class="col-md-2">
      <label class="form-label">Train Window</label>
      <input id="exp-train" type="number" class="form-control" value="750" />
    </div>
    <div class="col-md-2">
      <label class="form-label">Test Window</label>
      <input id="exp-test" type="number" class="form-control" value="63" />
    </div>
    <div class="col-md-1 d-flex align-items-end">
      <button id="exp-run" class="btn-elev w-100">Run</button>
    </div>
    <div class="col-12">
      <small class="text-secondary">Param grid (JSON). Example: {"max_depth":[3,5],"learning_rate":[0.03,0.07],"n_estimators":[300,500]}</small>
      <textarea id="exp-grid" class="form-control mt-1" rows="2">{"n_estimators":[300,500],"max_depth":[3,5],"learning_rate":[0.03,0.07],"subsample":[0.8,1.0],"colsample_bytree":[0.8,1.0]}</textarea>
      <div class="form-check mt-2">
        <input id="exp-persist" class="form-check-input" type="checkbox" />
        <label class="form-check-label" for="exp-persist">Persist best model</label>
      </div>
    </div>
  </form>
</div>

<div class="row g-3">
  <div class="col-lg-6">
    <div class="soft-card card h-100">
      <div class="card-body">
        <div class="text-muted small mb-2">Best Equity Curve</div>
        <div id="exp-equity" style="height:320px;"></div>
      </div>
    </div>
  </div>
  <div class="col-lg-6">
    <div class="soft-card card h-100">
      <div class="card-body small">
        <div class="text-muted small mb-2">Best Parameters</div>
        <pre id="exp-best" class="mb-0"></pre>
      </div>
    </div>
  </div>
</div>

<div class="soft-card card mt-3">
  <div class="card-body">
    <div class="d-flex justify-content-between align-items-center mb-2">
      <div class="text-muted small">Candidate Summary (sorted by Sharpe)</div>
      <input id="exp-filter" class="form-control form-control-sm" style="width:200px" placeholder="Filter JSON" />
    </div>
    <div class="table-responsive" style="max-height:400px;">
      <table class="table table-sm table-hover align-middle" id="exp-table">
        <thead class="table-light">
          <tr><th style="width:55%;">Params</th><th>Sharpe</th><th>IR</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}